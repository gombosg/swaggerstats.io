(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{192:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"prometheus-support"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-support","aria-hidden":"true"}},[t._v("#")]),t._v(" Prometheus Support")]),t._v(" "),s("h2",{attrs:{id:"metrics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metrics","aria-hidden":"true"}},[t._v("#")]),t._v(" Metrics")]),t._v(" "),s("p",[s("strong",[t._v("swagger-stats")]),t._v(" exposes metrics in "),s("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus"),s("OutboundLink")],1),t._v(" format, so you may use "),s("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana"),s("OutboundLink")],1),t._v(" for API monitoring and alerting")]),t._v(" "),s("p",[t._v("swagger-stats exposes Prometheus metrics via "),s("code",[t._v("/swagger-stats/metrics")]),t._v(":")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("GET /swagger-stats/metrics")])])]),t._v(" "),s("p",[t._v("The following metrics are provided:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("Name")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Type")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Labels")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Description")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_all_request_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("counter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests received")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_all_success_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("counter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests with success response")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_all_errors_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("counter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests with error response")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_all_client_error_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("counter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests with client error response")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_all_server_error_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("counter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests with server error response")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_all_request_in_processing_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("gauge")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests currently in processing (no response yet)")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("nodejs_process_memory_rss_bytes")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("gauge")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Node.js process resident memory (RSS) bytes")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("nodejs_process_memory_heap_total_bytes")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("gauge")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Node.js process memory heapTotal bytes")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("nodejs_process_memory_heap_used_bytes")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("gauge")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Node.js process memory heapUsed bytes")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("nodejs_process_memory_external_bytes")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("gauge")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Node.js process memory external bytes")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("nodejs_process_cpu_usage_percentage")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("gauge")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("-")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Node.js process CPU usage percentage")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_request_total")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("counter")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("method"),s("br"),t._v("path"),s("br"),t._v("code")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("The total number of all API requests")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_request_duration_milliseconds")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("histogram")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("method"),s("br"),t._v("path"),s("br"),t._v("code"),s("br"),t._v("le")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("API requests duration")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_request_size_bytes")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("histogram")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("method"),s("br"),t._v("path"),s("br"),t._v("code"),s("br"),t._v("le")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("API requests size")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("api_response_size_bytes")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("histogram")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("method"),s("br"),t._v("path"),s("br"),t._v("code"),s("br"),t._v("le")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("API response size")])])])]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"getting-prometheus-metrics-sample"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-prometheus-metrics-sample","aria-hidden":"true"}},[t._v("#")]),t._v(" Getting Prometheus Metrics Sample")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ curl http://<your app host:port>/swagger-stats/metrics\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('# HELP api_all_request_total The total number of all API requests received\n# TYPE api_all_request_total counter\napi_all_request_total 302\n\n# HELP api_all_success_total The total number of all API requests with success response\n# TYPE api_all_success_total counter\napi_all_success_total 267\n\n# HELP api_all_errors_total The total number of all API requests with error response\n# TYPE api_all_errors_total counter\napi_all_errors_total 35\n\n. . . .\n\n# HELP api_request_total The total number of all API requests\n# TYPE api_request_total counter\napi_request_total{method="GET",path="/v2/pet/findByStatus",code="200"} 13\napi_request_total{method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_total{method="GET",path="/v2/store/inventory",code="200"} 16\napi_request_total{method="GET",path="/v2/user/{username}",code="200"} 18\napi_request_total{method="POST",path="/v2/pet/{petId}",code="404"} 1\napi_request_total{method="POST",path="/v2/pet/{petId}/uploadImage",code="200"} 18\napi_request_total{method="POST",path="/v2/pet",code="200"} 16\napi_request_total{method="PUT",path="/v2/user/{username}",code="200"} 12\napi_request_total{method="GET",path="/v2/pet/findByTags",code="200"} 15\n\n. . . .\n# HELP api_request_duration_milliseconds API requests duration\n# TYPE api_request_duration_milliseconds histogram\napi_request_duration_milliseconds_bucket{le="5",method="GET",path="/v2/store/order/{orderId}",code="200"} 1\napi_request_duration_milliseconds_bucket{le="10",method="GET",path="/v2/store/order/{orderId}",code="200"} 1\napi_request_duration_milliseconds_bucket{le="25",method="GET",path="/v2/store/order/{orderId}",code="200"} 3\napi_request_duration_milliseconds_bucket{le="50",method="GET",path="/v2/store/order/{orderId}",code="200"} 7\napi_request_duration_milliseconds_bucket{le="100",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="250",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="500",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="1000",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="2500",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="5000",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="10000",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_bucket{le="+Inf",method="GET",path="/v2/store/order/{orderId}",code="200"} 16\napi_request_duration_milliseconds_sum{method="GET",path="/v2/store/order/{orderId}",code="200"} 911\napi_request_duration_milliseconds_count{method="GET",path="/v2/store/order/{orderId}",code="200"} 16\n. . . . \n\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br")])]),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"example-prometheus-scrape-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-prometheus-scrape-configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" Example Prometheus scrape configuration")]),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"simple-scrape"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#simple-scrape","aria-hidden":"true"}},[t._v("#")]),t._v(" Simple scrape")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sws-spectest'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10s'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metrics_path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/swagger-stats/metrics'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:3040'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"scrape-with-basic-authentication-enabled"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scrape-with-basic-authentication-enabled","aria-hidden":"true"}},[t._v("#")]),t._v(" Scrape with basic authentication enabled")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sws-authtest'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10s'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metrics_path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/swagger-stats/metrics'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:3050'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("basic_auth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'swagger-stats'")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'swagger-stats'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("h2",{attrs:{id:"grafana-dashboards"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#grafana-dashboards","aria-hidden":"true"}},[t._v("#")]),t._v(" Grafana Dashboards")]),t._v(" "),s("p",[s("strong",[t._v("swagger-stats")]),t._v(" Grafana Dashboards are published at "),s("a",{attrs:{href:"https://grafana.com/dashboards?search=swagger-stats",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://grafana.com/dashboards?search=swagger-stats"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("img",{attrs:{src:"/grafana-dashboard.png",alt:"dashboard"}})]),t._v(" "),s("h2",{attrs:{id:"prometheus-queries"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-queries","aria-hidden":"true"}},[t._v("#")]),t._v(" Prometheus Queries")]),t._v(" "),s("p",[t._v("Examples of Prometheus Queries using swagger-stats metrics")]),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"get-request-rate-error-rate-success-rate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-request-rate-error-rate-success-rate","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Request Rate, Error Rate, Success Rate")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('sum (irate(api_request_total[1m]))\n\nsum (irate(api_request_total{code=~"^5..$"}[1m]))\n\nsum (irate(api_request_total{code=~"^4..$"}[1m]))\n\nsum (irate(api_request_total{code=~"^2..$"}[1m]))\n\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-of-errors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-of-errors","aria-hidden":"true"}},[t._v("#")]),t._v(" Get % of errors")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("( api_all_errors_total / api_all_request_total ) * 100\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-apdex-score"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-apdex-score","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Apdex Score")]),t._v(" "),s("blockquote",[s("p",[t._v("How Apdex Score is calculated: "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Apdex",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apdex Score"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('(\n  sum(irate(api_request_duration_milliseconds_bucket{le="25",code=~"^2..$"}[1m]))\n+\n  (sum(irate(api_request_duration_milliseconds_bucket{le="100",code=~"^2..$"}[1m])) / 2)\n) / sum(irate(api_request_duration_milliseconds_count[1m]))\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-apdex-score-trend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-apdex-score-trend","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Apdex Score Trend")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('(\n  sum(irate(api_request_duration_milliseconds_bucket{le="25",code=~"^2..$"}[1m]))\n+\n  (sum(irate(api_request_duration_milliseconds_bucket{le="100",code=~"^2..$"}[1m]))/2)\n) / sum(irate(api_request_duration_milliseconds_count[1m]))\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-request-rate-by-method"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-request-rate-by-method","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Request Rate by Method")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sum by(method) (irate(api_request_total[1m]))\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-of-request-answered-within-threshold-over-time"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-of-request-answered-within-threshold-over-time","aria-hidden":"true"}},[t._v("#")]),t._v(" Get % of request answered within threshold, over time")]),t._v(" "),s("blockquote",[s("p",[t._v("Use "),s("code",[t._v('le="XX"')]),t._v(" to set threshold, i.e. "),s("code",[t._v('le="25"')]),t._v(" for % of request answered under 25 msec.\nValues of "),s("code",[t._v("le")]),t._v(" should be from the list of bucket values specified in swagger-stats option "),s("code",[t._v("durationBuckets")])])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('( sum(irate(api_request_duration_milliseconds_bucket{le="25"}[1m])) /  sum(irate(api_request_duration_milliseconds_count[1m])) ) * 100\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-top-3-api-calls-by-path-over-time"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-top-3-api-calls-by-path-over-time","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Top 3 API Calls by Path, over time")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("topk(3, sum(irate(api_request_total[1m])) by (path))\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-top-3-5xx-errors-by-path-over-time"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-top-3-5xx-errors-by-path-over-time","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Top 3 5XX Errors By Path, over time")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('topk(3, sum(irate(api_request_total{code=~"^5..$"}[1m])) by (path))\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-node-js-process-cpu-usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-node-js-process-cpu-usage","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Node.js process CPU Usage %")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("nodejs_process_cpu_usage_percentage\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("br"),t._v(" "),s("h3",{attrs:{id:"get-node-js-process-used-heap-in-mb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-node-js-process-used-heap-in-mb","aria-hidden":"true"}},[t._v("#")]),t._v(" Get Node.js process Used Heap in MB")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("(nodejs_process_memory_heap_used_bytes)/1048576\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])])])},[],!1,null,null,null);e.default=r.exports}}]);